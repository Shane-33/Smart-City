/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.11.0
 */
import{m as n,n as t,o as e,p as r,r as o,d as i,u}from"./p-1ecee1c3.js";
/*!
* focus-trap 7.5.4
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function a(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,r)}return e}function c(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?a(Object(e),!0).forEach((function(t){s(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function s(n,t,e){return(t=function(n){var t=function(n){if("object"!=typeof n||null===n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==typeof t?t:String(t)}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var f=function(n){return"Tab"===(null==n?void 0:n.key)||9===(null==n?void 0:n.keyCode)},l=function(n){return f(n)&&!n.shiftKey},v=function(n){return f(n)&&n.shiftKey},d=function(n){return setTimeout(n,0)},b=function(n,t){var e=-1;return n.every((function(n,r){return!t(n)||(e=r,!1)})),e},p=function(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];return"function"==typeof n?n.apply(void 0,e):n},w=function(n){return n.target.shadowRoot&&"function"==typeof n.composedPath?n.composedPath()[0]:n.target},h=[];const m=globalThis.calciteConfig?.focusTrapStack||[];function y(a,s){const{el:y}=a,F=s?.focusTrapEl||y;if(!F)return;const O={clickOutsideDeactivates:!0,escapeDeactivates:!1,fallbackFocus:F,setReturnFocus:n=>(i(n),!1),...s?.focusTrapOptions,document:y.ownerDocument,tabbableOptions:u,trapStack:m};var k,j,T,D,g,E,N,P,A,x,B,R,S,C,I,G,K,M,U,Y,L,q,z,H;a.focusTrap=(k=F,D=(null==(j=O)?void 0:j.document)||document,g=(null==j?void 0:j.trapStack)||h,E=c({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:l,isKeyBackward:v},j),N={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},P=function(n,t,e){return n&&void 0!==n[t]?n[t]:E[e||t]},A=function(n,t){var e="function"==typeof(null==t?void 0:t.composedPath)?t.composedPath():void 0;return N.containerGroups.findIndex((function(t){var r=t.container,o=t.tabbableNodes;return r.contains(n)||(null==e?void 0:e.includes(r))||o.find((function(t){return t===n}))}))},x=function(n){var t=E[n];if("function"==typeof t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];t=t.apply(void 0,r)}if(!0===t&&(t=void 0),!t){if(void 0===t||!1===t)return t;throw new Error("`".concat(n,"` was specified but was not a node, or did not return a node"))}var i=t;if("string"==typeof t&&!(i=D.querySelector(t)))throw new Error("`".concat(n,"` as selector refers to no known node"));return i},B=function(){var n=x("initialFocus");if(!1===n)return!1;if(void 0===n||!o(n,E.tabbableOptions))if(A(D.activeElement)>=0)n=D.activeElement;else{var t=N.tabbableGroups[0];n=t&&t.firstTabbableNode||x("fallbackFocus")}if(!n)throw new Error("Your focus-trap needs to have at least one focusable element");return n},R=function(){if(N.containerGroups=N.containers.map((function(o){var i=n(o,E.tabbableOptions),u=t(o,E.tabbableOptions),a=i.length>0?i[0]:void 0,c=i.length>0?i[i.length-1]:void 0,s=u.find((function(n){return e(n)})),f=u.slice().reverse().find((function(n){return e(n)})),l=!!i.find((function(n){return r(n)>0}));return{container:o,tabbableNodes:i,focusableNodes:u,posTabIndexesFound:l,firstTabbableNode:a,lastTabbableNode:c,firstDomTabbableNode:s,lastDomTabbableNode:f,nextTabbableNode:function(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=i.indexOf(n);return r<0?t?u.slice(u.indexOf(n)+1).find((function(n){return e(n)})):u.slice(0,u.indexOf(n)).reverse().find((function(n){return e(n)})):i[r+(t?1:-1)]}}})),N.tabbableGroups=N.containerGroups.filter((function(n){return n.tabbableNodes.length>0})),N.tabbableGroups.length<=0&&!x("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(N.containerGroups.find((function(n){return n.posTabIndexesFound}))&&N.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},S=function n(t){var e=t.activeElement;if(e)return e.shadowRoot&&null!==e.shadowRoot.activeElement?n(e.shadowRoot):e},C=function n(t){!1!==t&&t!==S(document)&&(t&&t.focus?(t.focus({preventScroll:!!E.preventScroll}),N.mostRecentlyFocusedNode=t,function(n){return n.tagName&&"input"===n.tagName.toLowerCase()&&"function"==typeof n.select}(t)&&t.select()):n(B()))},I=function(n){var t=x("setReturnFocus",n);return t||!1!==t&&n},G=function(n){var t=n.target,i=n.event,u=n.isBackward,a=void 0!==u&&u;t=t||w(i),R();var c=null;if(N.tabbableGroups.length>0){var s=A(t,i),l=s>=0?N.containerGroups[s]:void 0;if(s<0)c=a?N.tabbableGroups[N.tabbableGroups.length-1].lastTabbableNode:N.tabbableGroups[0].firstTabbableNode;else if(a){var v=b(N.tabbableGroups,(function(n){return t===n.firstTabbableNode}));if(v<0&&(l.container===t||o(t,E.tabbableOptions)&&!e(t,E.tabbableOptions)&&!l.nextTabbableNode(t,!1))&&(v=s),v>=0){var d=N.tabbableGroups[0===v?N.tabbableGroups.length-1:v-1];c=r(t)>=0?d.lastTabbableNode:d.lastDomTabbableNode}else f(i)||(c=l.nextTabbableNode(t,!1))}else{var p=b(N.tabbableGroups,(function(n){return t===n.lastTabbableNode}));if(p<0&&(l.container===t||o(t,E.tabbableOptions)&&!e(t,E.tabbableOptions)&&!l.nextTabbableNode(t))&&(p=s),p>=0){var h=N.tabbableGroups[p===N.tabbableGroups.length-1?0:p+1];c=r(t)>=0?h.firstTabbableNode:h.firstDomTabbableNode}else f(i)||(c=l.nextTabbableNode(t))}}else c=x("fallbackFocus");return c},K=function(n){var t=w(n);A(t,n)>=0||(p(E.clickOutsideDeactivates,n)?T.deactivate({returnFocus:E.returnFocusOnDeactivate}):p(E.allowOutsideClick,n)||n.preventDefault())},M=function(n){var t=w(n),e=A(t,n)>=0;if(e||t instanceof Document)e&&(N.mostRecentlyFocusedNode=t);else{var o;n.stopImmediatePropagation();var i=!0;if(N.mostRecentlyFocusedNode)if(r(N.mostRecentlyFocusedNode)>0){var u=A(N.mostRecentlyFocusedNode),a=N.containerGroups[u].tabbableNodes;if(a.length>0){var c=a.findIndex((function(n){return n===N.mostRecentlyFocusedNode}));c>=0&&(E.isKeyForward(N.recentNavEvent)?c+1<a.length&&(o=a[c+1],i=!1):c-1>=0&&(o=a[c-1],i=!1))}}else N.containerGroups.some((function(n){return n.tabbableNodes.some((function(n){return r(n)>0}))}))||(i=!1);else i=!1;i&&(o=G({target:N.mostRecentlyFocusedNode,isBackward:E.isKeyBackward(N.recentNavEvent)})),C(o||N.mostRecentlyFocusedNode||B())}N.recentNavEvent=void 0},U=function(n){if(("Escape"===(null==(t=n)?void 0:t.key)||"Esc"===(null==t?void 0:t.key)||27===(null==t?void 0:t.keyCode))&&!1!==p(E.escapeDeactivates,n))return n.preventDefault(),void T.deactivate();var t;(E.isKeyForward(n)||E.isKeyBackward(n))&&function(n){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];N.recentNavEvent=n;var e=G({event:n,isBackward:t});e&&(f(n)&&n.preventDefault(),C(e))}(n,E.isKeyBackward(n))},Y=function(n){var t=w(n);A(t,n)>=0||p(E.clickOutsideDeactivates,n)||p(E.allowOutsideClick,n)||(n.preventDefault(),n.stopImmediatePropagation())},L=function(){if(N.active)return function(n,t){if(n.length>0){var e=n[n.length-1];e!==t&&e.pause()}var r=n.indexOf(t);-1===r||n.splice(r,1),n.push(t)}(g,T),N.delayInitialFocusTimer=E.delayInitialFocus?d((function(){C(B())})):C(B()),D.addEventListener("focusin",M,!0),D.addEventListener("mousedown",K,{capture:!0,passive:!1}),D.addEventListener("touchstart",K,{capture:!0,passive:!1}),D.addEventListener("click",Y,{capture:!0,passive:!1}),D.addEventListener("keydown",U,{capture:!0,passive:!1}),T},q=function(){if(N.active)return D.removeEventListener("focusin",M,!0),D.removeEventListener("mousedown",K,!0),D.removeEventListener("touchstart",K,!0),D.removeEventListener("click",Y,!0),D.removeEventListener("keydown",U,!0),T},z="undefined"!=typeof window&&"MutationObserver"in window?new MutationObserver((function(n){n.some((function(n){return Array.from(n.removedNodes).some((function(n){return n===N.mostRecentlyFocusedNode}))}))&&C(B())})):void 0,H=function(){z&&(z.disconnect(),N.active&&!N.paused&&N.containers.map((function(n){z.observe(n,{subtree:!0,childList:!0})})))},(T={get active(){return N.active},get paused(){return N.paused},activate:function(n){if(N.active)return this;var t=P(n,"onActivate"),e=P(n,"onPostActivate"),r=P(n,"checkCanFocusTrap");r||R(),N.active=!0,N.paused=!1,N.nodeFocusedBeforeActivation=D.activeElement,null==t||t();var o=function(){r&&R(),L(),H(),null==e||e()};return r?(r(N.containers.concat()).then(o,o),this):(o(),this)},deactivate:function(n){if(!N.active)return this;var t=c({onDeactivate:E.onDeactivate,onPostDeactivate:E.onPostDeactivate,checkCanReturnFocus:E.checkCanReturnFocus},n);clearTimeout(N.delayInitialFocusTimer),N.delayInitialFocusTimer=void 0,q(),N.active=!1,N.paused=!1,H(),function(n,t){var e=n.indexOf(t);-1!==e&&n.splice(e,1),n.length>0&&n[n.length-1].unpause()}(g,T);var e=P(t,"onDeactivate"),r=P(t,"onPostDeactivate"),o=P(t,"checkCanReturnFocus"),i=P(t,"returnFocus","returnFocusOnDeactivate");null==e||e();var u=function(){d((function(){i&&C(I(N.nodeFocusedBeforeActivation)),null==r||r()}))};return i&&o?(o(I(N.nodeFocusedBeforeActivation)).then(u,u),this):(u(),this)},pause:function(n){if(N.paused||!N.active)return this;var t=P(n,"onPause"),e=P(n,"onPostPause");return N.paused=!0,null==t||t(),q(),H(),null==e||e(),this},unpause:function(n){if(!N.paused||!N.active)return this;var t=P(n,"onUnpause"),e=P(n,"onPostUnpause");return N.paused=!1,null==t||t(),R(),L(),H(),null==e||e(),this},updateContainerElements:function(n){var t=[].concat(n).filter(Boolean);return N.containers=t.map((function(n){return"string"==typeof n?D.querySelector(n):n})),N.active&&R(),H(),this}}).updateContainerElements(k),T)}function F(n,t){n.focusTrapDisabled||n.focusTrap?.activate(t)}function O(n,t){n.focusTrap?.deactivate(t)}function k(n){n.focusTrap?.updateContainerElements(n.el)}export{F as a,y as c,O as d,k as u}