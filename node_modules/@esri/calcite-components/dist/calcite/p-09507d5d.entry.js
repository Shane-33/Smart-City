/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v1.11.0
 */
import{h as t,r as i,c as s,H as e,a}from"./p-daaff213.js";import{c as n,d as o,H as r}from"./p-a9c49dc3.js";import{g as h}from"./p-6e607443.js";import{c as l,d as c,u as d}from"./p-a0a1a6f8.js";import{c as p,d as u}from"./p-289967d1.js";import{s as m,a as f,c as v}from"./p-629513a0.js";import{c as g,d as b}from"./p-953058ba.js";import{u as y,c as w,s as k,d as x}from"./p-7a636ec7.js";import{f as j}from"./p-1ecee1c3.js";import"./p-835eb17c.js";import"./p-23351819.js";import"./p-e8c77b5b.js";import"./p-a97ae2a2.js";const C=({full:i,scale:s,partial:e})=>t("calcite-icon",{class:e?void 0:"icon",icon:i?"star-f":"star",scale:s}),z=class{constructor(t){i(this,t),this.calciteRatingChange=s(this,"calciteRatingChange",6),this.handleRatingPointerOver=()=>{this.isKeyboardInteraction=!1},this.handleRatingPointerOut=()=>{this.isKeyboardInteraction=!0,this.hoverValue=null},this.handleHostKeyDown=()=>{this.isKeyboardInteraction=!0},this.handleLabelKeyDown=t=>{const i=this.getValueFromLabelEvent(t),s=t.key,e=" "==s?void 0:Number(s);if(this.emit=!0,isNaN(e))switch(s){case"Enter":case" ":this.value=this.required||this.value!==i?i:0;break;case"ArrowLeft":this.value=this.getPreviousRatingValue(i),this.updateFocus(),t.preventDefault();break;case"ArrowRight":this.value=this.getNextRatingValue(i),this.updateFocus(),t.preventDefault();break;case"Tab":this.hoverValue=null}else(!this.required&&e>=0&&e<=this.max||this.required&&e>0&&e<=this.max)&&(this.value=e),this.updateFocus()},this.handleInputChange=t=>{if(!0===this.isKeyboardInteraction){const i=Number(t.target.value);this.hoverValue=i,this.value=i}},this.handleLabelPointerOver=t=>{this.hoverValue=this.getValueFromLabelEvent(t)},this.handleLabelPointerDown=t=>{const i=t.currentTarget,s=this.getValueFromLabelEvent(t);this.hoverValue=s,this.emit=!0,this.value=this.required||this.value!==s?s:0,i.focus()},this.handleLabelClick=t=>{t.preventDefault()},this.handleLabelFocus=t=>{const i=this.getValueFromLabelEvent(t);this.hoverValue=i},this.setLabelEl=t=>{this.labelElements.push(t)},this.emit=!1,this.guid=`calcite-ratings-${h()}`,this.isKeyboardInteraction=!0,this.labelElements=[],this.max=5,this.average=void 0,this.count=void 0,this.disabled=!1,this.form=void 0,this.messages=void 0,this.messageOverrides=void 0,this.name=void 0,this.readOnly=!1,this.required=!1,this.scale="m",this.showChip=!1,this.value=0,this.effectiveLocale="",this.defaultMessages=void 0,this.hoverValue=void 0}onMessagesChange(){}handleValueUpdate(t){this.hoverValue=t,this.emit&&this.calciteRatingChange.emit(),this.emit=!1}effectiveLocaleChange(){y(this,this.effectiveLocale)}connectedCallback(){l(this),g(this),w(this),p(this),n(this)}async componentWillLoad(){await k(this),m(this)}componentWillRender(){this.starsMap=Array.from({length:this.max},((t,i)=>{const s=i+1,e=this.average&&this.average+1-s,a=s<=this.hoverValue;return{average:!this.hoverValue&&this.average&&!this.value&&s<=this.average,checked:s===this.value,fraction:e,hovered:a,id:`${this.guid}-${s}`,partial:!this.hoverValue&&!this.value&&!a&&e>0&&e<1,selected:this.value>=s,value:s,tabIndex:this.getTabIndex(s)}}))}componentDidLoad(){f(this)}disconnectedCallback(){c(this),b(this),x(this),u(this),o(this)}componentDidRender(){d(this)}render(){return t(e,{onKeyDown:this.handleHostKeyDown,onPointerOut:this.handleRatingPointerOut,onPointerOver:this.handleRatingPointerOver},t("span",{class:"wrapper"},t("fieldset",{class:"fieldset",disabled:this.disabled},t("legend",{class:"visually-hidden"},this.messages.rating),this.starsMap.map((({average:i,checked:s,fraction:e,hovered:a,id:n,partial:o,selected:r,value:h,tabIndex:l})=>t("label",{class:{star:!0,selected:r,hovered:a,average:i,partial:o},"data-value":h,htmlFor:n,onClick:this.handleLabelClick,onFocus:this.handleLabelFocus,onKeyDown:this.handleLabelKeyDown,onPointerDown:this.handleLabelPointerDown,onPointerOver:this.handleLabelPointerOver,tabIndex:l,ref:this.setLabelEl},t("input",{checked:s,class:"visually-hidden",disabled:this.disabled||this.readOnly,id:n,name:this.guid,onChange:this.handleInputChange,tabIndex:-1,type:"radio",value:h}),t(C,{full:r||i,scale:this.scale}),o&&t("div",{class:"fraction",style:{width:100*e+"%"}},t(C,{full:!0,partial:!0,scale:this.scale})),t("span",{class:"visually-hidden"},this.messages.stars.replace("{num}",`${h}`))))),(this.count||this.average)&&this.showChip?t("calcite-chip",{scale:this.scale,value:this.count?.toString()},!!this.average&&t("span",{class:"number--average"},this.average.toString()),!!this.count&&t("span",{class:"number--count"},"(",this.count?.toString(),")")):null),t(r,{component:this})))}onLabelClick(){this.setFocus()}updateFocus(){this.hoverValue=this.value,this.labelElements[this.value-1].focus()}getTabIndex(t){return this.readOnly||this.value!==t&&(this.value||1!==t)?-1:0}getValueFromLabelEvent(t){return Number(t.currentTarget.getAttribute("data-value"))}getNextRatingValue(t){return 5===t?1:t+1}getPreviousRatingValue(t){return 1===t?5:t-1}async setFocus(){await v(this),j(this.el)}static get assetsDirs(){return["assets"]}get el(){return a(this)}static get watchers(){return{messageOverrides:["onMessagesChange"],value:["handleValueUpdate"],effectiveLocale:["effectiveLocaleChange"]}}};z.style=":host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host([read-only]) *,:host([disabled]) *,:host([read-only]) ::slotted(*),:host([disabled]) ::slotted(*){pointer-events:none}:host{position:relative;display:flex;align-items:center;inline-size:-moz-fit-content;inline-size:fit-content}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){block-size:1.5rem;--calcite-rating-spacing-unit:0.25rem}:host([scale=m]){block-size:2rem;--calcite-rating-spacing-unit:0.5rem}:host([scale=l]){block-size:2.75rem;--calcite-rating-spacing-unit:0.75rem}.fieldset{margin:0;display:flex;border-width:0;padding:0;align-items:center;gap:var(--calcite-rating-spacing-unit)}.wrapper{display:inline-block}.star{transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;position:relative;display:flex;flex-direction:column;cursor:pointer;color:var(--calcite-ui-border-input)}.star:focus{outline:2px solid var(--calcite-ui-focus-color, var(--calcite-ui-brand));outline-offset:calc(\n            2px *\n            calc(\n              1 -\n              2 * clamp(\n                0,\n                var(--calcite-ui-focus-offset-invert),\n                1\n              )\n            )\n          )}.average,.fraction{color:var(--calcite-ui-warning)}.hovered,.selected{color:var(--calcite-ui-brand)}.fraction{transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;position:absolute;pointer-events:none;inset-block-start:0;overflow:hidden;inset-inline-start:0}calcite-chip{pointer-events:none;cursor:default}.number--average{font-weight:bold}.number--count{color:var(--calcite-ui-text-2);font-style:italic}.number--count:not(:first-child){margin-inline-start:var(--calcite-rating-spacing-unit)}.visually-hidden{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}::slotted(input[slot=hidden-form-input]){margin:0 !important;opacity:0 !important;outline:none !important;padding:0 !important;position:absolute !important;inset:0 !important;transform:none !important;-webkit-appearance:none !important;z-index:-1 !important}:host([hidden]){display:none}[hidden]{display:none}";export{z as calcite_rating}