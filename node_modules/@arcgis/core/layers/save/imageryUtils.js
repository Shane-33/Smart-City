/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{save as e,saveAs as t}from"./utils.js";import{getWGS84ExtentForItem as r,addTypeKeyword as a,TypeKeyword as i}from"../../portal/support/portalItemUtils.js";const s="Image Service",l="imagery-layer-save",y="imagery-layer-save-as",n="imagery-tile-layer-save",o="imagery-tile-layer-save-as";function m(e){if("imagery"===e.type)return{isValid:!0};const{raster:t}=e,r="Function"===t?.datasetFormat?t.primaryRasters?.rasters[0]:t;return{isValid:"RasterTileServer"===r?.datasetFormat&&("Raster"===r.tileType||"Map"===r.tileType),errorMessage:"imagery tile layer should be created from a tiled image service."}}function c(e){const t=e.layerJSON;return Promise.resolve(t&&Object.keys(t).length?t:null)}async function p(e,t){const{parsedUrl:s,title:l,fullExtent:y}=e;t.url=s.path,t.title||=l,t.extent=await r(y),"imagery-tile"===e.type&&a(t,i.TILED_IMAGERY)}async function u(t,r){const a="imagery"===t.type?l:n;return e({layer:t,itemType:s,validateLayer:m,createItemData:c,errorNamePrefix:a},r)}async function g(e,r,a){const i="imagery"===e.type?y:o;return t({layer:e,itemType:s,validateLayer:m,createItemData:c,errorNamePrefix:i,newItem:r,setItemProperties:p},a)}export{u as save,g as saveAs};
