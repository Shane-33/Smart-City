/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{a as t}from"../../../chunks/mat3f64.js";import{a}from"../../../chunks/mat4f64.js";import{z as s}from"../../../chunks/vec3f64.js";import{p as n}from"../../../chunks/mat4.js";function h(t,a,s){const[n,h,o,i]=a,[c,r,z,u]=s;return M(t,n,h,o,i,c,r,z,u)}function M(t,s,h,M,i,c,r,z,u){let e=!1;0===s.z&&0===h.z&&0===M.z&&0===i.z&&(s.z=h.z=M.z=i.z=1,t.z=1),s.z=s.z??1,h.z=h.z??1,M.z=M.z??1,i.z=i.z??1,0===c.z&&0===r.z&&0===z.z&&0===u.z&&(e=!0,c.z=r.z=z.z=u.z=1),c.z=c.z??1,r.z=r.z??1,z.z=z.z??1,u.z=u.z??1;const x=o(s,h,M,i),m=o(c,r,z,u),y=n(a(),x),f=a();f[0]=m[0]*y[0]+m[1]*y[4]+m[2]*y[8]+m[3]*y[12],f[1]=m[0]*y[1]+m[1]*y[5]+m[2]*y[9]+m[3]*y[13],f[2]=m[0]*y[2]+m[1]*y[6]+m[2]*y[10]+m[3]*y[14],f[3]=m[0]*y[3]+m[1]*y[7]+m[2]*y[11]+m[3]*y[15],f[4]=m[4]*y[0]+m[5]*y[4]+m[6]*y[8]+m[7]*y[12],f[5]=m[4]*y[1]+m[5]*y[5]+m[6]*y[9]+m[7]*y[13],f[6]=m[4]*y[2]+m[5]*y[6]+m[6]*y[10]+m[7]*y[14],f[7]=m[4]*y[3]+m[5]*y[7]+m[6]*y[11]+m[7]*y[15],f[8]=m[8]*y[0]+m[9]*y[4]+m[10]*y[8]+m[11]*y[12],f[9]=m[8]*y[1]+m[9]*y[5]+m[10]*y[9]+m[11]*y[13],f[10]=m[8]*y[2]+m[9]*y[6]+m[10]*y[10]+m[11]*y[14],f[11]=m[8]*y[3]+m[9]*y[7]+m[10]*y[11]+m[11]*y[15],f[12]=m[12]*y[0]+m[13]*y[4]+m[14]*y[8]+m[15]*y[12],f[13]=m[12]*y[1]+m[13]*y[5]+m[14]*y[9]+m[15]*y[13],f[14]=m[12]*y[2]+m[13]*y[6]+m[14]*y[10]+m[15]*y[14],f[15]=m[12]*y[3]+m[13]*y[7]+m[14]*y[11]+m[15]*y[15];const b=f[0]*t.x+f[1]*t.y+f[2]*t.z+f[3],q=f[4]*t.x+f[5]*t.y+f[6]*t.z+f[7],N=f[8]*t.x+f[9]*t.y+f[10]*t.z+f[11];let p=f[12]*t.x+f[13]*t.y+f[14]*t.z+f[15];return 0===p&&(p=1),{x:b/p,y:q/p,z:e?0:N/p}}function o(t,a,s,h){const M=z([h.x,h.y,h.z,1],n(new Array(16),[t.x,a.x,s.x,0,t.y,a.y,s.y,0,t.z,a.z,s.z,0,1,1,1,1])),o=M[0],i=M[1],c=M[2],r=new Array(16);return r[0]=o*t.x,r[1]=i*a.x,r[2]=c*s.x,r[3]=0,r[4]=o*t.y,r[5]=i*a.y,r[6]=c*s.y,r[7]=0,r[8]=o*t.z,r[9]=i*a.z,r[10]=c*s.z,r[11]=0,r[12]=o,r[13]=i,r[14]=c,r[15]=1,r}function i(t,a,n,h){const M=s();return M[0]=t[0]+a[0]*n,M[1]=t[1]+a[1]*n,M[2]=t[2]+a[2]*(n/h),M}function c(t,a,n){const h=s();return h[0]=t[0]*a,h[1]=t[1]*a,h[2]=t[2]*(a/n),h}function r(t,a){const[n,h,M]=t,o=s();return o[0]=n*a[0]+h*a[3]+M*a[6],o[1]=n*a[1]+h*a[4]+M*a[7],o[2]=n*a[2]+h*a[5]+M*a[8],o}function z(t,a){const[s,n,h,M]=t,o=new Array(4);return o[0]=s*a[0]+n*a[1]+h*a[2]+M*a[3],o[1]=s*a[4]+n*a[5]+h*a[6]+M*a[7],o[2]=s*a[8]+n*a[9]+h*a[10]+M*a[11],o[3]=s*a[12]+n*a[13]+h*a[14]+M*a[15],o}function u(a,s){const n=Math.PI/180,h=t();if("OPK"===a){const t=Number(s[0])*n,a=Number(s[1])*n,M=Number(s[2])*n;h[0]=Math.cos(a)*Math.cos(M),h[1]=Math.cos(t)*Math.sin(M)+Math.sin(t)*Math.sin(a)*Math.cos(M),h[2]=Math.sin(t)*Math.sin(M)-Math.cos(t)*Math.sin(a)*Math.cos(M),h[3]=-Math.cos(a)*Math.sin(M),h[4]=Math.cos(t)*Math.cos(M)-Math.sin(t)*Math.sin(a)*Math.sin(M),h[5]=Math.sin(t)*Math.cos(M)+Math.cos(t)*Math.sin(a)*Math.sin(M),h[6]=Math.sin(a),h[7]=-Math.sin(t)*Math.cos(a),h[8]=Math.cos(t)*Math.cos(a)}else{const t=Number(s[0])*n,a=Number(s[1])*n,M=Number(s[2])*n;h[0]=Math.cos(t)*Math.cos(M)-Math.sin(t)*Math.cos(a)*Math.sin(M),h[1]=Math.sin(t)*Math.cos(M)*-1-Math.cos(t)*Math.cos(a)*Math.sin(M),h[2]=Math.sin(M)*Math.sin(a)*-1,h[3]=Math.cos(t)*Math.sin(M)+Math.sin(t)*Math.cos(a)*Math.cos(M),h[4]=Math.sin(t)*Math.sin(M)*-1+Math.cos(t)*Math.cos(a)*Math.cos(M),h[5]=Math.cos(M)*Math.sin(a),h[6]=Math.sin(t)*Math.sin(a)*-1,h[7]=Math.cos(t)*Math.sin(a)*-1,h[8]=Math.cos(a)}return h}function e(t,a,s){const n=Math.sin(s*Math.PI/180),h=Math.cos(s*Math.PI/180),M=[[t,0],[t,a],[0,a]];M.forEach(((t,a)=>{M[a]=[h*t[0]-n*t[1],n*t[0]+h*t[1]]}));const o={xmin:Math.min(0,M[0][0],M[1][0],M[2][0]),xmax:Math.max(0,M[0][0],M[1][0],M[2][0]),ymin:Math.min(0,M[0][1],M[1][1],M[2][1]),ymax:Math.max(0,M[0][1],M[1][1],M[2][1])};return{hfov:Math.abs(o.xmax-o.xmin),vfov:Math.abs(o.ymax-o.ymin)}}function x(t,a,s,n,h,M){const o=s*(a.x-t.x)+n*(a.y-t.y)+h*(a.z-t.z);if(0===o)return null;const i=-(s*t.x+n*t.y+h*t.z+M)/o;return{x:t.x+i*(a.x-t.x),y:t.y+i*(a.y-t.y),z:t.z+i*(a.z-t.z)}}function m(t,a){const s=Math.PI/180,n=t.y*s,h=t.x*s,M=t.z||0,o=a[0]*s,i=a[1]*s,c=a[2]/Math.sqrt(1-a[3]*Math.sin(o)**2),r=h-i,z=a[2]/Math.sqrt(1-a[3]*Math.sin(n)**2),u=a[3]*(c*Math.sin(o)-z*Math.sin(n));return{x:(z+M)*Math.cos(n)*Math.sin(r),y:(z+M)*(Math.sin(n)*Math.cos(o)-Math.sin(o)*Math.cos(n)*Math.cos(r))+u*Math.cos(o),z:(z+M)*(Math.sin(n)*Math.sin(o)+Math.cos(o)*Math.cos(n)*Math.cos(r))-c+u*Math.sin(o)}}function y(t,a){const s=Math.PI/180,n=Number(t.x),h=Number(t.y),M=Number(t.z),o=a[0]*s,i=a[1]*s,c=a[2]/Math.sqrt(1-a[3]*Math.sin(o)**2),r=n/c,z=h/c,u=M/c,e=Math.cos(o)-Math.sin(o)*z+Math.cos(o)*u,x=Math.sin(o)+Math.cos(o)*z+Math.sin(o)*u,m=Math.sqrt(e**2+r**2),y=a[3]*c*Math.sin(o),f=o,b=Math.atan(x/m-(y-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(f)**2))*Math.sin(f))/(c*m)),q=Math.atan(x/m-(y-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(b)**2))*Math.sin(b))/(c*m)),N=Math.atan(x/m-(y-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(q)**2))*Math.sin(q))/(c*m)),p=Math.atan(x/m-(y-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(N)**2))*Math.sin(N))/(c*m)),l=Math.atan(n/(c*e))+i;return{x:l/s,y:p/s,z:n/(Math.cos(p)*Math.sin(l-i))-a[2]/Math.sqrt(1-a[3]*Math.sin(p)**2),spatialReference:{wkid:4326}}}export{u as calculateRotationMatrix,e as computeHFOVAndVFOV,m as geographicToLTP,x as getPlaneLineIntersectionPoint,o as linearEquationSolve,y as ltpToGeographic,M as projectiveTransform,h as projectiveTransform2,i as scaleAndAddWithFactor,c as scaleWithFactor,r as transformMat3,z as transformMat4};
