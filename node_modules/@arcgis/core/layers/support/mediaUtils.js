/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import"../../geometry.js";import{getInfo as e}from"../../geometry/support/spatialReferenceUtils.js";import t from"./ControlPointsGeoreference.js";import n from"../../geometry/Extent.js";import o from"../../geometry/Point.js";const i=100,r=.5;async function a(a,s){a.loaded||await a.load();const{width:c,height:p}=a.content,{spatialReference:m}=s,l=e(m);let y=!1;if(l){const e=l.valid[1]-l.valid[0];s.width>e&&(s=new n({xmin:l.valid[0],ymin:s.ymin,xmax:l.valid[1],ymax:s.ymax,spatialReference:s.spatialReference}),y=!0)}const x=s.expand(r),{center:f,width:h,height:w}=x,P=y||c>p?h:c/p*w,d=y||c>p?p/c*h:w,u=f.x-P/2,g=f.x+P/2,R=f.y+d/2,j=f.y-d/2;return new t({controlPoints:[{sourcePoint:{x:i,y:p-i},mapPoint:new o({x:u,y:j,spatialReference:m})},{sourcePoint:{x:i,y:i},mapPoint:new o({x:u,y:R,spatialReference:m})},{sourcePoint:{x:c-i,y:i},mapPoint:new o({x:g,y:R,spatialReference:m})},{sourcePoint:{x:c-i,y:p-i},mapPoint:new o({x:g,y:j,spatialReference:m})}],width:c,height:p})}function s(e){const n=e.georeference;if("control-points"!==n.type)return null;const i={wkid:0},{width:r,height:a}=n,s=n.controlPoints;return new t({controlPoints:s.map((e=>{const{x:t,y:n}=e.sourcePoint;return{sourcePoint:{x:t,y:n},mapPoint:new o({x:t,y:a-n,spatialReference:i})}})),width:r,height:a})}export{a as createDefaultControlPointsGeoreference,s as createLocalModeControlPointsGeoreference};
