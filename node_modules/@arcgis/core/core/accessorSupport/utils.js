/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{handlesGroup as r}from"../handleUtils.js";import{clone as n}from"../lang.js";function t(r){return r.__accessor__??null}function e(r,n){return null!=r?.metadatas?.[n]}function i(r,n){const e=t(r);return e?e.getDependsInfo(r,n,""):""}function u(r,n,t){if(t){return o(r,n,{policy:t,path:""})}return o(r,n,null)}function o(r,t,e){return t?Object.keys(t).reduce(((r,i)=>{const u=i;let s=null,a="merge";if(e&&(s=e.path?`${e.path}.${i}`:i,a=e.policy(s)),"replace"===a)return r[u]=t[u],r;if("replace-arrays"===a&&Array.isArray(r[u]))return r[u]=t[u],r;if(void 0===r[u])return r[u]=n(t[u]),r;let l=r[u],c=t[u];if(l===c)return r;if(Array.isArray(c)||Array.isArray(r))l=l?Array.isArray(l)?r[u]=l.concat():r[u]=[l]:r[u]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach((r=>{l.includes(r)||l.push(r)})));else if(c&&"object"==typeof c)if(e){const n=e.path;e.path=s,r[u]=o(l,c,e),e.path=n}else r[u]=o(l,c,null);else r.hasOwnProperty(i)&&!t.hasOwnProperty(i)||(r[u]=c);return r}),r||{}):r}function s(r){return r&&("string"!=typeof r||r.includes("."))?a(r):r}function a(r){return Array.isArray(r)?r:r.split(".")}function l(r){return r.includes(",")?r.split(",").map((r=>r.trim())):[r.trim()]}function c(r){if(Array.isArray(r)){const n=[];for(const t of r)n.push(...l(t));return n}return l(r)}function f(r){if(!r.includes("?"))return null;const n=a(r),t=new Array(n.length);for(let e=0;e<n.length;e++){const r=n[e];t[e]="?"===r[r.length-1],t[e]&&(n[e]=r.slice(0,-1))}return{fullPath:n.join("."),conditional:t}}function p(n,t,e,i){const u=c(t);if(1!==u.length){const t=u.map((r=>i(n,r,e)));return r(t)}return i(n,u[0],e)}export{i as getDependsInfo,t as getProperties,e as isPropertyDeclared,u as merge,p as parse,f as parseConditionalPath,a as pathToArray,s as pathToStringOrArray,c as splitPath};
