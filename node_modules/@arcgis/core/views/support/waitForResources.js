/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{createResolver as e}from"../../core/promiseUtils.js";import{whenOnce as r}from"../../core/reactiveUtils.js";import{debug as i}from"../../core/scheduling.js";import{dispatch as t}from"../../core/accessorSupport/watch.js";function n(e){switch(e.type){case"2d":return o(e);case"3d":if(e)return t(),i.dispatch(),r((()=>!e.updating))}return Promise.resolve()}function o(r){const n=e();let o=performance.now();const s=()=>{if(t(),i.dispatch(),!r.ready||r.updating||!r.stationary||r.rendering||!0===r.layerViewManager?.updating||!0===r.labelManager?.updating||!0===r.graphicsView?.updating||!0===r.magnifier?.visible&&null!=r.magnifier?.position&&(!a(r)?.mask||!a(r)?.overlay)||r.allLayerViews.some((e=>!0===e.updating)))return!0;return!!r.allLayerViews.find((e=>{const r=!e.isFulfilled(),i=e.updating&&!e.suspended;return r||i}))};function u(){if(!r.destroyed&&s())o=null,setTimeout(u,16);else{o||(o=performance.now());performance.now()-o>=200?n():setTimeout(u,16)}}return setTimeout(u,16),n.promise}function a(e){return e._magnifierView}export{n as default};
