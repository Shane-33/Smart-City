/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import r from"./aspectProcessor.js";import e from"./bandArithmeticProcessor.js";import t from"./compositeBandProcessor.js";import o from"./contrastProcessor.js";import s from"./convolutionProcessor.js";import c from"./curvatureProcessor.js";import n from"./extractBandProcessor.js";import i from"./focalStatisticsProcessor.js";import m from"./localProcessor.js";import a from"./maskProcessor.js";import p from"./ndviProcessor.js";import u from"./remapProcessor.js";import f from"./reprojectProcessor.js";import l from"./slopeProcessor.js";import j from"./stretchProcessor.js";import{ContextType as d}from"../../../../webgl/contextUtils.js";import{SizedPixelFormat as P,PixelFormat as w,TextureSamplingMode as x,PixelType as b,TextureWrapMode as h}from"../../../../webgl/enums.js";import{Texture as T}from"../../../../webgl/Texture.js";import{TextureDescriptor as g}from"../../../../webgl/TextureDescriptor.js";const A=new Map;function B(r,e,t){const o=new g;return o.width=e,o.height=t,o.internalFormat=r.type===d.WEBGL2?P.RGBA32F:w.RGBA,o.samplingMode=x.NEAREST,o.dataType=b.FLOAT,o.isImmutable=r.type===d.WEBGL2,o.wrapMode=h.CLAMP_TO_EDGE,o}function v(r,e,t,o){const{context:s,requestRender:c,allowDelayedRender:n}=r,i=o.createProgram(r,t);return n&&null!=c&&!i.compiled?(c(),null):(s.bindFramebuffer(e),s.setViewport(0,0,e.width,e.height),s.useProgram(i),i)}function E(r){return A.get(r.toLowerCase())}function F(r,e,t,o){const s=r.rasterFunction.name.toLowerCase(),c="reproject"===s?f:E(s);if(null==c)return;const n=v(r,t,o,c);if(!n)return;c.bindTextureAndUniforms(r,n,o),e.draw();const[i,m]=o.getRasterTextureSize("reproject"===s),a=B(r.context,i,m),p=new T(r.context,a);if(t.copyToTexture(0,0,i,m,0,0,p),"reproject"===s)o.rasterTexture=p,o.projected=!0;else{const e=r.hasBranches?r.rasterFunction.id:0;o.functionTextures[e]=p}}A.set("aspect",r),A.set("bandarithmetic",e),A.set("compositeband",t),A.set("convolution",s),A.set("contrastbrightness",o),A.set("curvature",c),A.set("extractband",n),A.set("statistics",i),A.set("local",m),A.set("mask",a),A.set("ndvi",p),A.set("remap",u),A.set("slope",l),A.set("stretch",j);export{B as createTextureDescriptor,F as process};
