/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{bidiText as e}from"../../../core/BidiText.js";import{pt2px as t}from"../../../core/screenUtils.js";import{getXAnchorDirection as i,getYAnchorDirection as n}from"../engine/webgl/alignmentUtils.js";import{magicLabelLineHeight as o,glyphSize as r}from"../engine/webgl/definitions.js";import{shapeGlyphs as s}from"../engine/webgl/mesh/templates/shapingUtils.js";async function a(a,l,m){const d=i("center"),g=n("middle"),f=l.painter.textureManager.rasterizeItem(a.toJSON(),window.devicePixelRatio||1,void 0,m),[,c]=e(a.text),h=(await f).glyphMosaicItems;return s(h??[],c,{angle:a.angle??0,xOffset:t(a.xoffset??0),yOffset:t(a.yoffset??0),lineHeight:o*Math.max(.25,a.lineHeight),maxLineWidth:Math.max(32,Math.min(t(a.lineWidth),512)),decoration:a.font.decoration,scale:Math.min(Math.round(t(a.font.size)),127)/r,hAlign:d,vAlign:g,isCIM:!1,hasBackground:!!a.backgroundColor,borderLineSize:a.borderLineSize}).boundsT}let l=a;async function m(e,t,i){return l(e,t.stage,i)}const d={stubGetTextBounds:e=>l=e,restoreGetTextBounds:()=>l=a};export{m as getTextBounds,d as test};
