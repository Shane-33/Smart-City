/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{colorVectorToColorAndOpacity as e}from"../../../core/colorUtils.js";import{i as t}from"../../../chunks/mat4.js";import{f as r,b as n,e as o,n as c}from"../../../chunks/vec3.js";import{sv3d as i,sm4d as a}from"../../../geometry/support/vectorStacks.js";import{hydrateGeometry as l}from"../../../layers/graphics/hydratedFeatures.js";import{Manipulator3D as s}from"./Manipulator3D.js";import{RenderObject as u}from"./RenderObject.js";import{computeCentroid as m}from"../layers/graphics/graphicUtils.js";import{CullFaceOptions as p}from"../webgl-engine/lib/basicInterfaces.js";import{createSphereGeometry as f}from"../webgl-engine/lib/GeometryUtil.js";import{RenderOccludedFlag as g}from"../webgl-engine/lib/Material.js";import{ColorMaterial as d}from"../webgl-engine/materials/ColorMaterial.js";import{ShadedColorMaterial as j}from"../webgl-engine/materials/ShadedColorMaterial.js";import{ManipulatorStateCustomFlags as h}from"../../interactive/interfaces.js";function w(t,r=g.OccludeAndTransparent,n=!0){const o=e(t),c=!(t[3]<1);return n?new j({color:o,writeDepth:c,cullFace:p.Back,renderOccluded:r,isDecoration:!0}):new d({color:o,writeDepth:c,cullFace:p.Back,renderOccluded:r,isDecoration:!0})}function b(t,r=g.OccludeAndTransparent){const n=e(t);return new d({color:n,writeDepth:!0,cullFace:p.Front,renderOccluded:r,isDecoration:!0})}const O=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1});function y(e,t,r=h.None){const n=w(t),o=[new u(f(n,1,32,32),r)];return new s({view:e,renderObjects:o})}const D=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function F(e,c,l,s){const u=r(i.get(),e,l),m=M(u,n(i.get(),s,u),l,a.get());t(m,m);const p=o(i.get(),c,m);return Math.atan2(p[1],p[0])}function M(e,t,r,o){const a=c(i.get(),e),l=c(i.get(),t),s=n(i.get(),a,l);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=0,o[4]=l[0],o[5]=l[1],o[6]=l[2],o[7]=0,o[8]=s[0],o[9]=s[1],o[10]=s[2],o[11]=0,o[12]=r[0],o[13]=r[1],o[14]=r[2],o[15]=1,o}function k(e,t){const r=e.getViewForGraphic(t);return null!=r&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null}function v(e,t,r){const n=k(e,r);null==n?A(t,r.geometry):t.elevationAlignedLocation=n}function A(e,t){if(null==t)return;const r="mesh"===t.type?t.anchor:m(t);null!=r&&(e.location=l(r))}export{F as calculateInputRotationTransform,M as calculateTranslateRotateFromBases,w as createManipulatorMaterial,b as createManipulatorOutlineMaterial,y as createSphereManipulator,k as getGraphicAttachmentOrigin,v as placeAtGraphic,O as rotateManipulatorDefaults,D as worldScaledManipulatorSettings};
