/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{screenToMapXYForGraphic as t}from"../dragEventPipeline3D.js";import{ManipulatorType as i}from"../ManipulatorType.js";import{Manipulation as e}from"./Manipulation.js";import{createGraphicMoveDragPipeline as r}from"./moveUtils.js";import{createManipulatorDragEventPipeline as a,addMapDelta as o,addScreenDelta as s}from"../../../../interactive/dragEventPipeline.js";import{GraphicManipulator as n}from"../../../../interactive/GraphicManipulator.js";class l extends e{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphicState=t.graphicState,this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null}forEachManipulator(t){t(this._manipulator,i.TRANSLATE_XY)}createGraphicDragPipeline(t){return r(this._graphicState.graphic,t,(t=>this.createDragPipeline(t)),this._view.state.viewingMode)}createDragPipeline(i){const e=this._view,r=this._graphicState.graphic,n=null!=r.geometry?r.geometry.spatialReference:null;return a(this._manipulator,((a,l,p,h,c)=>{const u=l.next(t(c,e,r,n)).next(o()).next(s());i(a,u,p,h,c)}))}_createManipulator(){const t=this._view,i=this._graphicState.graphic;this._manipulator=new n({graphic:i,view:t,selectable:!0,cursor:"move"})}}export{l as MoveXYGraphicManipulation};
