/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{c as n,f as e,g as r,o as t,C as o}from"../../../../chunks/vec3.js";import{c as i}from"../../../../chunks/vec3f64.js";import{wrap as c}from"../../../../geometry/support/ray.js";import{i as s,k as a}from"../../../../chunks/sphere.js";import{defaultConstraintOptions as f,interactionDirectionTowardsConstraintMinimization as m,adjustRangeForInteraction as u}from"./common.js";import{InteractionType as p}from"./InteractionType.js";function d(n,e,r=f){if(!n.state.isLocal)return 0;const t=n.state.constraints.distance;if(!n.pointsOfInterest.surfaceOrigin.renderLocation||t===1/0)return 0;g.min=0,g.max=t,O(n,r,g);const o=l(n,e),i=g.max-o;return i>=-1e-6?0:i}function y(t,o,i=f){const u=d(t,o,i);if(0===u)return!1;const p=t.pointsOfInterest.surfaceOrigin;if(!p.renderLocation)return!1;const y=l(t,o)+u,O=n(j,o.eye),g=m(o,i.interactionDirection,L(o,p.renderLocation,h),I);if(!s(a(p.renderLocation,y),c(o.eye,g),k))return!1;o.eye=k;const C=e(x,o.eye,O);o.center=r(k,o.center,C);const N=t.renderCoordsHelper.getAltitude(o.center),v=t.renderCoordsHelper.intersectInfiniteManifold(o.ray,N,k);return null!=v&&(o.center=v),!0}function O(n,e,r){const t=e.interactionType;if(t===p.NONE)return;const{min:o,max:i}=r,{interactionStartCamera:c,interactionFactor:s}=e;if(!c)return;const a=t===p.ZOOM||t===p.PAN,f=d(n,c),m=0===f?0:l(n,c);r.min=o,r.max=i;u(f,m,a,s,.05*m,r)}function l(n,e){const r=n.pointsOfInterest.surfaceOrigin;return r.renderLocation?t(e.eye,r.renderLocation):0}function L(n,e,r){return o(r,n.eye,e)}const g={min:0,max:0},j=i(),x=i(),I=i(),h=i(),k=i();export{y as applyDistanceConstraint,d as getDistanceConstraintError};
