/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{releaseMaybe as t}from"../../../core/maybe.js";import{g as e}from"../../../chunks/vec3.js";import{empty as s}from"../../../geometry/support/aaBoundingBox.js";import{internalAssert as i}from"./terrainUtils.js";import{decompressNormal as r,compressNormal as n}from"../webgl-engine/lib/Normals.js";class o{constructor(){this.indices=null,this.vertexAttributes=null,this.boundingBox=s(),this.indexCount=0,this.numVerticesPerSide=0,this.uvRange=[0,0,1,1],this.outerEdges=[null,null,null,null],this.innerEdges=[null,null,null,null]}release(){this.vertexAttributes=t(this.vertexAttributes),this.indices=null}}class u{constructor(t,e,s,i,r){this.attributes=t,this.localOrigin=e,this.index0=s,this.stride=i,this.count=r}getVertexIndex(t){return this.getAttributeIndex(t)}getAttributeIndex(t){return i(0<=t&&t<this.count),this.index0+this.stride*t}_getVertexRaw(t,e){this.attributes.position.getVec(t,e)}getVertexPos(t,s){this._getVertexRaw(this.getAttributeIndex(s),t),e(t,t,this.localOrigin)}getNormal(t,e){const{typedBuffer:s,typedBufferStride:i}=this.attributes.normalCompressed;r(t,s,this.getAttributeIndex(e),i)}_setNormal(t,e,s,i){const{typedBuffer:r,typedBufferStride:o}=this.attributes.normalCompressed;n(r,t,e,s,i,o)}_setUV(t,e,s){h(this.attributes.uv0,t,e,s)}setNormalFromValues(t,e,s,i){this._setNormal(this.getAttributeIndex(t),e,s,i)}setVertexFromValuesRawPositionUV(t,e,s,i,r,n){const o=this.getAttributeIndex(t);this.attributes.position.setValues(o,e,s,i),this._setUV(o,r,n)}setVertexFromValuesRawPositionUVNormal(t,e,s,i,r,n,o,u,l){const h=this.getAttributeIndex(t);this.attributes.position.setValues(h,e,s,i),this._setUV(h,r,n),this._setNormal(h,o,u,l)}}const l=16384;function h(t,e,s,i){t.setValues(e,s*l,i*l)}function a(t,e,s,i){t<i[0]?i[0]=t:t>i[3]&&(i[3]=t),e<i[1]?i[1]=e:e>i[4]&&(i[4]=e),s<i[2]?i[2]=s:s>i[5]&&(i[5]=s)}export{u as EdgeDescriptor,o as PatchGeometry,h as encodeUVInBuffer,a as minMaxBoundingBox};
