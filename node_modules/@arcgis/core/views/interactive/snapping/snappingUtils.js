/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{watch as e,syncAndInitial as t}from"../../../core/reactiveUtils.js";import{intersection as n}from"../../../core/SetUtils.js";import{sqlAnd as r}from"../../../core/sql.js";import{mergeTimeExtents as o}from"../../../core/timeUtils.js";import{a as i}from"../../../chunks/vec3.js";import{makeDehydratedPoint as s}from"../../../layers/graphics/dehydratedPoint.js";import a from"../../../rest/support/Query.js";import{ViewEventPriorities as l}from"../../input/InputManager.js";import{snappingKeys as c}from"../keybindings.js";import{fromAnyMapPoint as p}from"../sketch/normalizedPoint.js";function d(e,t){const n=e.length===t.length&&e[0]===t[0]&&e[1]===t[1];switch(e.length){case 2:return n;case 3:return n&&e[2]===t[2];case 4:return n&&e[2]===t[2]&&e[3]===t[3]}return!1}function u(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function g(e,t){return Math.sqrt(u(e,t))}function m(e,t){t.sort(((t,n)=>i(t.targetPoint,e)-i(n.targetPoint,e)))}var f;function E({point:e,distance:t,returnEdge:n,vertexMode:i,coordinateHelper:{spatialReference:l},filter:c},p,d){return d=null!=d?d.clone():new a({where:"1=1"}),c&&(d.geometry=c.geometry,d.distance=c.distance,d.spatialRelationship=c.spatialRelationship,d.where=r(d.where,c.where),d.timeExtent=o(d.timeExtent,c.timeExtent),d.objectIds=y(d.objectIds,c.objectIds)),{point:s(e[0],e[1],e[2],l.toJSON()),mode:p,distance:t,returnEdge:n,vertexMode:i,query:d.toJSON()}}function y(e,t){return e||t?t?e?Array.from(n(new Set(e),new Set(t))):t:e:null}function h(e,t,n){return{left:p(e.leftVertex.pos,t,n),right:p(e.rightVertex.pos,t,n)}}function j(e){return e.createQuery()}function w(n,r=(()=>{})){const o=e((()=>({view:n.view,snappingOptions:n.snappingOptions})),(({view:e,snappingOptions:t})=>{const o="snapping-toggle",i=l.TOOL;if(n.removeHandles(o),e&&null!=t){const s=[e.on("key-down",(e=>{e.key!==c.toggle||e.repeat||(t.enabledToggled=!0,r())}),i),e.on("key-up",(e=>{e.key===c.toggle&&(t.enabledToggled=!1,r())}),i),e.on("pointer-move",(e=>{const n=e.native.ctrlKey;t.enabledToggled!==n&&(t.enabledToggled=n,r())}),i)];n.addHandles(s,o)}}),t);n.addHandles(o)}function R(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass&&"utilityNetworks"in e&&!!e?.utilityNetworks?.length}!function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"}(f||(f={}));export{f as LineSegmentHintType,h as editEdgeToSnappingEdge,R as isUtilityNetworkWebMap,j as makeFilter,E as makeSnappingQuery,d as objectEqual,g as screenDistance,w as setupSnappingToggleHandles,m as sortCandidatesInPlace,u as squaredScreenDistance};
