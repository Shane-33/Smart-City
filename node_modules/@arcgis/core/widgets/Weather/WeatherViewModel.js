/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import t from"../../core/Accessor.js";import r from"../../core/Logger.js";import{watch as n,syncAndInitial as o}from"../../core/reactiveUtils.js";import{property as s}from"../../core/accessorSupport/decorators/property.js";import{subclass as i}from"../../core/accessorSupport/decorators/subclass.js";import a from"../../views/3d/environment/CloudyWeather.js";import l from"../../views/3d/environment/FoggyWeather.js";import p from"../../views/3d/environment/RainyWeather.js";import h from"../../views/3d/environment/SnowyWeather.js";import y from"../../views/3d/environment/SunnyWeather.js";import{validateWeatherType as m}from"../../views/3d/environment/weather.js";import{WeatherState as u,WeatherError as w}from"./enums.js";const c="esri.widgets.Weather.WeatherViewModel",d=r.getLogger(c);let v=class extends t{constructor(e){super(e),this.view=null,this._weatherByType={sunny:new y,cloudy:new a,rainy:new p,snowy:new h,foggy:new l},this._settingWeather=!1}initialize(){this.addHandles([n((()=>this.current),(e=>{this._settingWeather||null==e||(this._weatherByType={...this._weatherByType,[e.type]:e})}),o)])}get state(){const e=this.view;return null!=e&&e.ready?null!=this.error?this.error===w.NotVisible?u.Ready:u.Error:u.Ready:u.Disabled}get weatherByType(){return this._weatherByType}get error(){const e=this.view;return null!=e&&e.ready?"3d"!==e.type?w.UnsupportedView:"local"===e.viewingMode?w.LocalScene:e.environment.atmosphereEnabled?e.environmentManager.weatherVisible?null:w.NotVisible:w.NoAtmosphere:null}get current(){return this._environment?.weather??this._weatherByType.sunny}set current(e){const t=this._environment;t&&(t.weather=e)}get _environment(){const e=this.view;return null!=e&&"3d"===e.type?e.environment:null}setWeatherByType(e){if(!m(e,d))return;const t=this._environment;null!=t&&(this._settingWeather=!0,t.weather=this._weatherByType[e],this._settingWeather=!1)}setSnowCoverEnabled(e){const t=this.current;"snowCover"in t&&(t.snowCover=e?"enabled":"disabled")}};e([s()],v.prototype,"view",void 0),e([s()],v.prototype,"state",null),e([s()],v.prototype,"_weatherByType",void 0),e([s()],v.prototype,"weatherByType",null),e([s()],v.prototype,"error",null),e([s()],v.prototype,"current",null),e([s()],v.prototype,"_environment",null),v=e([i(c)],v);const g=v;export{g as default};
