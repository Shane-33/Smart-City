/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../core/arrayUtils.js";import{getDisplayFieldName as t}from"../../../layers/support/fieldUtils.js";import{loadPanelContentComponents as a,PanelContentSection as l,PanelContent as r}from"./PanelContent.js";import{ItemList as s}from"../../FeatureTemplates/ItemList.js";import"../../support/widgetUtils.js";import{tsx as o}from"../../support/jsxFactory.js";const n=()=>a();function i({editableItems:t,filterText:a,id:n,messagesTemplates:i,onFilterTextChange:m,onSelectFeature:c,workflow:u}){const f=new Map,p=u.data.candidates;let y=0;p.map((e=>({label:d(e),id:e.attributes[e.layer.objectIdField],data:e}))).filter((e=>{const{label:l,data:r}=e,s=a.toLowerCase(),{title:o}=r.layer,n=t.find((e=>e.layer===r.layer));if(!n)return null;const{attachmentsOnUpdateEnabled:i,supports:d}=n;return(d.includes("update")||d.includes("delete")||i)&&(!s||l?.toLowerCase().includes(s)||o?.toLowerCase().includes(s))})).filter(e).forEach((e=>{y++;const t=e.data.layer;f.has(t)?f.get(t)?.items.push(e):f.set(t,{id:`${t.id}`,label:t.title??"",items:[e]})}));const b=t.toArray().map((({layer:e})=>f.get(e))).filter(e),h=y>10||a.length>0;return o(r,{key:"feature-list"},o(l,null,s({enableListScroll:!1,filterEnabled:h,filterText:a,id:n,items:b,messages:{filterPlaceholder:i.filterPlaceholder,noItems:i.noItems,noMatches:i.noMatches},onFilterChange:e=>m(e),onItemMouseEnter:e=>c(e.data),onItemMouseLeave:()=>c(null),onItemSelect:e=>c(e.data,!0)})))}function d(e){const a=e.layer;if(!a)return null;const l=a.fieldsIndex.get(a.objectIdField),r=l.alias||l.name,{attributes:s}=e,o=t(a);return o&&s[o]&&`${s[o]}`||`${r}: ${s[l.name]}`}export{i as FeatureList,n as loadFeatureListComponents};
