/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{ignoreAbortErrors as t}from"../core/promiseUtils.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import"../core/accessorSupport/ensureType.js";import"../core/arrayUtils.js";import"../core/has.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import l from"./Widget.js";import o from"./Slice/SliceViewModel.js";import{loadCalciteComponents as r}from"./support/componentsUtils.js";import{globalCss as n}from"./support/globalCss.js";import{Heading as c}from"./support/Heading.js";import{legacyIcon as a}from"./support/legacyIcon.js";import"./support/widgetUtils.js";import{messageBundle as d}from"./support/decorators/messageBundle.js";import{tsx as u}from"./support/jsxFactory.js";const p="esri-slice",y={base:p,widgetIcon:a.slice,actions:`${p}__actions`,cancelButton:`${p}__cancel-button`,container:`${p}__container`,error:`${p}__error`,excludeButton:`${p}__exclude-button`,hint:`${p}__hint`,hintText:`${p}__hint-text`,layerItem:`${p}__layer-item`,layerList:`${p}__layer-list`,layerListHeading:`${p}__layer-list-title`,newSliceButton:`${p}__clear-button`};let m=class extends l{constructor(e,s){super(e,s),this.headingLevel=3,this.iconClass=y.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new o,this._onNewSliceClick=()=>{t(this.viewModel.start())}}loadDependencies(){return r({action:()=>import("@esri/calcite-components/dist/components/calcite-action.js"),button:()=>import("@esri/calcite-components/dist/components/calcite-button.js"),"list-item":()=>import("@esri/calcite-components/dist/components/calcite-list-item.js"),list:()=>import("@esri/calcite-components/dist/components/calcite-list.js")})}get active(){return this.viewModel.active}get analysis(){return this.viewModel.analysis}set analysis(e){this.viewModel.analysis=e}get excludedLayers(){return this.viewModel.excludedLayers}set excludedLayers(e){this.viewModel.excludedLayers=e}get excludeGroundSurface(){return this.viewModel.excludeGroundSurface}set excludeGroundSurface(e){this.viewModel.excludeGroundSurface=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}get hasVoxelLayers(){const e=this.viewModel?.view;return null!=e&&e.allLayerViews.some((e=>"voxel-3d"===e.type))}render(){return u("div",{class:this.classes(y.base,n.widget,n.panel),role:"presentation"},this.visible?u("div",{class:y.container},this.viewModel.supported?[this._renderHint(),this._renderLayerList(),this._renderActions()]:this._renderUnsupported()):null)}_renderUnsupported(){return u("div",{class:y.error,key:"unsupported"},u("p",null,this.messages.unsupported))}_renderHint(){const{hasVoxelLayers:e,messages:t,viewModel:s}=this,{active:i,layersMode:l,state:o}=s;let r=null;return i&&("exclude"===l?r=t.excludeHint:"ready"===o&&(r=e?t.voxelHint:t.hint)),r?u("div",{class:y.hint,key:"hint"},u("p",{class:y.hintText},r),u("p",{class:y.hintText},t.verticalHint)):null}_renderLayerList(){const{excludedLayers:e,excludeGroundSurface:t,headingLevel:s,messages:i,viewModel:l}=this,{layersMode:o,state:r}=l,n="slicing"===r||"sliced"===r,a=e?e.toArray().map((e=>this._renderLayerItem({uid:e.uid,title:e.title,onClick:()=>(this.excludedLayers.remove(e),!1)}))):[];return t&&a.push(this._renderLayerItem({uid:"ground",title:i.ground,onClick:()=>(this.excludeGroundSurface=!1,!1)})),"exclude"!==o&&n&&0!==a.length?u("div",{class:y.layerList,key:"settings"},u(c,{class:y.layerListHeading,level:s},i.excludedLayers),u("calcite-list",{selectionMode:"none"},a)):null}_renderActions(){const{messages:e,viewModel:t}=this,{active:s,state:i}=t,l="disabled"===i,o="slicing"===i||"sliced"===i,r="exclude"===t.layersMode,n=[];return s&&!o||r||n.push(u("calcite-button",{class:y.newSliceButton,disabled:l,key:"new-slice",onclick:this._onNewSliceClick},e.newSlice)),o&&!r&&n.push(u("calcite-button",{appearance:"outline-fill",class:y.excludeButton,disabled:l,key:"exclude",onclick:()=>t.enterExcludeLayerMode()},e.excludeLayer)),s&&r&&n.push(u("calcite-button",{appearance:"outline-fill",class:y.cancelButton,disabled:l,key:"cancel-exclude",onclick:()=>t.exitExcludeLayerMode()},e.cancel)),0===n.length?null:u("div",{class:y.actions},n)}_renderLayerItem(e){return u("calcite-list-item",{class:y.layerItem,key:e.uid,label:e.title??""},u("calcite-action",{icon:"x",onclick:e.onClick,scale:"s",slot:"actions-end",text:this.messages.includeLayer}))}};e([s()],m.prototype,"active",null),e([s({constructOnly:!0,nonNullable:!0})],m.prototype,"analysis",null),e([s()],m.prototype,"excludedLayers",null),e([s()],m.prototype,"excludeGroundSurface",null),e([s()],m.prototype,"headingLevel",void 0),e([s()],m.prototype,"iconClass",void 0),e([s()],m.prototype,"icon",void 0),e([s()],m.prototype,"label",null),e([s(),d("esri/widgets/Slice/t9n/Slice")],m.prototype,"messages",void 0),e([s()],m.prototype,"view",null),e([s({type:o})],m.prototype,"viewModel",void 0),e([s()],m.prototype,"visible",null),e([s()],m.prototype,"hasVoxelLayers",null),m=e([i("esri.widgets.Slice")],m);const h=m;export{h as default};
