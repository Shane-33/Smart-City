/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{makeHandle as e}from"../core/handleUtils.js";import{watch as o}from"../core/reactiveUtils.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import"../core/accessorSupport/ensureType.js";import"../core/arrayUtils.js";import"../core/has.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import r from"../widgets/Widget.js";import{isWidget as n}from"../widgets/support/widget.js";import{createFocusTrap as a}from"focus-trap";import{tsx as c}from"../widgets/support/jsxFactory.js";import{messageBundle as l}from"../widgets/support/decorators/messageBundle.js";const d="esri-identity-modal",p={base:d,open:`${d}--open`,closed:`${d}--closed`,title:`${d}__title`,dialog:`${d}__dialog`,content:`${d}__content`,closeButton:`${d}__close-button`,iconClose:"esri-icon-close"};let u=class extends r{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.content=null,this.open=!1,this._focusTrap=null,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.addHandles(o((()=>this.open),(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}get title(){return this.messages?.auth.signIn}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,r=e&&!!o,n={[p.open]:r,[p.closed]:!r},a=c("button",{"aria-label":i.close,bind:this,class:p.closeButton,onclick:this._close,title:i.close,type:"button"},c("span",{"aria-hidden":"true",class:p.iconClose})),l=`${t}_title`,d=`${t}_content`,u=s?c("h1",{class:p.title,id:l},s):null,h=r?c("div",{afterCreate:this._createFocusTrap,"aria-describedby":d,"aria-labelledby":l,bind:this,class:p.dialog,role:"dialog"},a,u,this._renderContent(d)):null;return c("div",{class:this.classes(p.base,n),tabIndex:-1},h)}_destroyFocusTrap(){this._focusTrap?.deactivate({onDeactivate:()=>{}}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=a(t,{initialFocus:"input",onDeactivate:this._close}),this._toggleFocusTrap()}));this.addHandles(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return"string"==typeof e?c("div",{class:p.content,id:t,innerHTML:e}):n(e)?c("div",{class:p.content,id:t},e.render()):e instanceof HTMLElement?c("div",{afterCreate:this._attachToNode,bind:e,class:p.content,id:t}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([s({readOnly:!0})],u.prototype,"container",void 0),t([s()],u.prototype,"content",void 0),t([s()],u.prototype,"open",void 0),t([s(),l("esri/t9n/common")],u.prototype,"messages",void 0),t([s()],u.prototype,"title",null),u=t([i("esri.identity.IdentityModal")],u);const h=u;export{h as default};
