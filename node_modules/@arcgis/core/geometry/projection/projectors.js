/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{rad2deg as n,clamp as C,deg2rad as l,asinClamped as E}from"../../core/mathUtils.js";import{getMetersPerUnitForSR as e}from"../../core/unitUtils.js";import{isSphericalECEF as S,WGS84ECEFSpatialReferenceLike as A,SphericalPCPFMarsLike as _,SphericalPCPFMoonLike as t}from"../ellipsoidUtils.js";import{earth as R,moon as u,mars as r}from"../support/Ellipsoid.js";import{earthEllipsoidConstants as P}from"../support/geodesicConstants.js";import{isWGS84 as O,isWebMercator as a,isPlateCarree as L,isMars as M,isMoon as N,equals as c}from"../support/spatialReferenceUtils.js";import{SupportedGCSWkids as s}from"../support/SupportedGCSWkids.js";var i;!function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",n[n.WGS84=2]="WGS84",n[n.WEB_MERCATOR=3]="WEB_MERCATOR",n[n.WGS84_ECEF=4]="WGS84_ECEF",n[n.CGCS2000=5]="CGCS2000",n[n.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",n[n.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",n[n.GCSMARS2000=8]="GCSMARS2000",n[n.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",n[n.GCSMOON2000=10]="GCSMOON2000",n[n.LON_LAT=11]="LON_LAT",n[n.PLATE_CARREE=12]="PLATE_CARREE"}(i||(i={}));const o={[i.WGS84]:{[i.CGCS2000]:null,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:f,[i.WGS84_COMPARABLE_LON_LAT]:f,[i.SPHERICAL_ECEF]:z,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:h,[i.PLATE_CARREE]:K,[i.WGS84]:f,[i.WGS84_ECEF]:$},[i.CGCS2000]:{[i.CGCS2000]:f,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:f,[i.WGS84_COMPARABLE_LON_LAT]:f,[i.SPHERICAL_ECEF]:z,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:K,[i.WGS84]:null,[i.WGS84_ECEF]:$},[i.GCSMARS2000]:{[i.CGCS2000]:null,[i.GCSMARS2000]:f,[i.GCSMOON2000]:null,[i.LON_LAT]:f,[i.WGS84_COMPARABLE_LON_LAT]:null,[i.SPHERICAL_ECEF]:null,[i.SPHERICAL_MARS_PCPF]:v,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:null,[i.WGS84]:null,[i.WGS84_ECEF]:null},[i.GCSMOON2000]:{[i.CGCS2000]:null,[i.GCSMARS2000]:null,[i.GCSMOON2000]:f,[i.LON_LAT]:f,[i.WGS84_COMPARABLE_LON_LAT]:null,[i.SPHERICAL_ECEF]:null,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:x,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:null,[i.WGS84]:null,[i.WGS84_ECEF]:null},[i.WEB_MERCATOR]:{[i.CGCS2000]:null,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:I,[i.WGS84_COMPARABLE_LON_LAT]:I,[i.SPHERICAL_ECEF]:p,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:f,[i.PLATE_CARREE]:w,[i.WGS84]:I,[i.WGS84_ECEF]:H},[i.WGS84_ECEF]:{[i.CGCS2000]:nn,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:nn,[i.WGS84_COMPARABLE_LON_LAT]:nn,[i.SPHERICAL_ECEF]:Cn,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:ln,[i.PLATE_CARREE]:j,[i.WGS84]:nn,[i.WGS84_ECEF]:f},[i.SPHERICAL_ECEF]:{[i.CGCS2000]:V,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:V,[i.WGS84_COMPARABLE_LON_LAT]:V,[i.SPHERICAL_ECEF]:f,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:X,[i.PLATE_CARREE]:q,[i.WGS84]:V,[i.WGS84_ECEF]:Y},[i.SPHERICAL_MARS_PCPF]:{[i.CGCS2000]:null,[i.GCSMARS2000]:Q,[i.GCSMOON2000]:null,[i.LON_LAT]:Q,[i.WGS84_COMPARABLE_LON_LAT]:null,[i.SPHERICAL_ECEF]:null,[i.SPHERICAL_MARS_PCPF]:f,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:null,[i.WGS84]:null,[i.WGS84_ECEF]:null},[i.SPHERICAL_MOON_PCPF]:{[i.CGCS2000]:null,[i.GCSMARS2000]:null,[i.GCSMOON2000]:J,[i.LON_LAT]:J,[i.WGS84_COMPARABLE_LON_LAT]:null,[i.SPHERICAL_ECEF]:null,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:f,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:null,[i.WGS84]:null,[i.WGS84_ECEF]:null},[i.UNKNOWN]:{[i.CGCS2000]:null,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:null,[i.WGS84_COMPARABLE_LON_LAT]:null,[i.SPHERICAL_ECEF]:null,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:f,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:null,[i.WGS84]:null,[i.WGS84_ECEF]:null},[i.LON_LAT]:{[i.CGCS2000]:f,[i.GCSMARS2000]:f,[i.GCSMOON2000]:f,[i.LON_LAT]:f,[i.WGS84_COMPARABLE_LON_LAT]:f,[i.SPHERICAL_ECEF]:z,[i.SPHERICAL_MARS_PCPF]:v,[i.SPHERICAL_MOON_PCPF]:x,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:h,[i.PLATE_CARREE]:K,[i.WGS84]:f,[i.WGS84_ECEF]:$},[i.WGS84_COMPARABLE_LON_LAT]:{[i.CGCS2000]:null,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:f,[i.WGS84_COMPARABLE_LON_LAT]:f,[i.SPHERICAL_ECEF]:z,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:null,[i.PLATE_CARREE]:K,[i.WGS84]:f,[i.WGS84_ECEF]:$},[i.PLATE_CARREE]:{[i.CGCS2000]:m,[i.GCSMARS2000]:null,[i.GCSMOON2000]:null,[i.LON_LAT]:m,[i.WGS84_COMPARABLE_LON_LAT]:m,[i.SPHERICAL_ECEF]:g,[i.SPHERICAL_MARS_PCPF]:null,[i.SPHERICAL_MOON_PCPF]:null,[i.UNKNOWN]:null,[i.WEB_MERCATOR]:b,[i.PLATE_CARREE]:f,[i.WGS84]:m,[i.WGS84_ECEF]:k}};function G(n){const C=F(n,Sn);return o[C][i.WGS84_COMPARABLE_LON_LAT]}function W(n,C,l=en()){return null==n||null==C?null:En(n,C,l).projector}function T(n,C){switch(W(n,C,_n)){case f:return"copy3";case z:return"wgs84ToSphericalECEF";case h:return"wgs84ToWebMercator";case K:return"wgs84ToPlateCarree";case $:return"wgs84ToWGS84ECEF";case I:return"webMercatorToWGS84";case p:return"webMercatorToSphericalECEF";case H:return"webMercatorToWGS84ECEF";case w:return"webMercatorToPlateCarree";case nn:return"wgs84ECEFToWGS84";case Cn:return"wgs84ECEFToSphericalECEF";case ln:return"wgs84ECEFToWebMercator";case V:return"sphericalECEFToWGS84";case X:return"sphericalECEFToWebMercator";case Q:return"sphericalMarsPCPFToMars2000";case J:return"sphericalMoonPCPFToMoon2000";case Y:return"sphericalECEFToWGS84ECEF";case v:return"mars2000ToSphericalPCPF";case x:return"moon2000ToSphericalPCPF";default:return null}}function F(n,C){return n?C.spatialReference===n?C.spatialReferenceId:(C.spatialReference=n,"metersPerUnit"in C&&(C.metersPerUnit=e(n,1)),S(n)?C.spatialReferenceId=i.SPHERICAL_ECEF:O(n)?C.spatialReferenceId=i.WGS84:a(n)?C.spatialReferenceId=i.WEB_MERCATOR:L(n)?C.spatialReferenceId=i.PLATE_CARREE:n.wkt===A.wkt?C.spatialReferenceId=i.WGS84_ECEF:n.wkid===s.CGCS2000?C.spatialReferenceId=i.CGCS2000:n.wkt===_.wkt?C.spatialReferenceId=i.SPHERICAL_MARS_PCPF:n.wkt===t.wkt?C.spatialReferenceId=i.SPHERICAL_MOON_PCPF:M(n)?C.spatialReferenceId=i.GCSMARS2000:N(n)?C.spatialReferenceId=i.GCSMOON2000:C.spatialReferenceId=i.UNKNOWN):i.UNKNOWN}function f(n,C,l,E){n!==l&&(l[E++]=n[C++],l[E++]=n[C++],l[E]=n[C])}function I(n,C,l,E){l[E++]=Rn*(n[C++]/R.radius),l[E++]=Rn*(Math.PI/2-2*Math.atan(Math.exp(-n[C++]/R.radius))),l[E]=n[C]}function p(n,C,l,E){I(n,C,l,E),z(l,E,l,E)}function H(n,C,l,E){I(n,C,l,E),$(l,E,l,E)}function d(n,l,E,e,S){const A=.4999999*Math.PI,_=C(tn*n[l+1],-A,A),t=Math.sin(_);E[e++]=tn*n[l]*S.radius,E[e++]=S.halfSemiMajorAxis*Math.log((1+t)/(1-t)),E[e]=n[l+2]}function h(n,C,l,E){d(n,C,l,E,R)}const B=R.radius*Math.PI/180,U=180/(R.radius*Math.PI);function K(n,C,l,E){l[E]=n[C]*B,l[E+1]=n[C+1]*B,l[E+2]=n[C+2]}function m(n,C,l,E){l[E]=n[C]*U,l[E+1]=n[C+1]*U,l[E+2]=n[C+2]}function w(n,C,l,E){I(n,C,l,E),K(l,E,l,E)}function j(n,C,l,E){nn(n,C,l,E),K(l,E,l,E)}function q(n,C,l,E){V(n,C,l,E),K(l,E,l,E)}function g(n,C,l,E){m(n,C,l,E),z(l,E,l,E)}function b(n,C,l,E){m(n,C,l,E),h(l,E,l,E)}function k(n,C,l,E){m(n,C,l,E),$(l,E,l,E)}function y(n,C,l,E,e){const S=e+n[C+2],A=tn*n[C+1],_=tn*n[C],t=Math.cos(A);l[E++]=Math.cos(_)*t*S,l[E++]=Math.sin(_)*t*S,l[E]=Math.sin(A)*S}function x(n,C,l,E){y(n,C,l,E,u.radius)}function v(n,C,l,E){y(n,C,l,E,r.radius)}function z(n,C,l,E){y(n,C,l,E,R.radius)}function D(n,C,l,e,S){const A=n[C],_=n[C+1],t=n[C+2],R=Math.sqrt(A*A+_*_+t*t),u=E(t/(0===R?1:R)),r=Math.atan2(_,A);l[e++]=Rn*r,l[e++]=Rn*u,l[e]=R-S}function J(n,C,l,E){D(n,C,l,E,u.radius)}function Q(n,C,l,E){D(n,C,l,E,r.radius)}function V(n,C,l,E){D(n,C,l,E,R.radius)}function X(n,C,l,E){V(n,C,l,E),h(l,E,l,E)}function Y(n,C,l,E){V(n,C,l,E),$(l,E,l,E)}function Z(n,C,l,E,e){const S=tn*n[C],A=tn*n[C+1],_=n[C+2],t=Math.sin(A),R=Math.cos(A),u=e.radius/Math.sqrt(1-e.eccentricitySquared*t*t);l[E++]=(u+_)*R*Math.cos(S),l[E++]=(u+_)*R*Math.sin(S),l[E++]=(u*(1-e.eccentricitySquared)+_)*t}function $(n,C,l,E){Z(n,C,l,E,R)}function nn(n,C,l,E){const e=P,S=n[C],A=n[C+1],_=n[C+2];let t,u,r,O,a,L,M,N,c,s,i,o,G,W,T,F,f,I,p,H,d;t=Math.abs(_),u=S*S+A*A,r=Math.sqrt(u),O=u+_*_,a=Math.sqrt(O),H=Math.atan2(A,S),L=_*_/O,M=u/O,W=e.a2/a,T=e.a3-e.a4/a,M>.3?(N=t/a*(1+M*(e.a1+W+L*T)/a),p=Math.asin(N),s=N*N,c=Math.sqrt(1-s)):(c=r/a*(1-L*(e.a5-W-M*T)/a),p=Math.acos(c),s=1-c*c,N=Math.sqrt(s)),i=1-R.eccentricitySquared*s,o=R.radius/Math.sqrt(i),G=e.a6*o,W=r-o*c,T=t-G*N,f=c*W+N*T,F=c*T-N*W,I=F/(G/i+f),p+=I,d=f+F*I/2,_<0&&(p=-p),l[E++]=Rn*H,l[E++]=Rn*p,l[E]=d}function Cn(n,C,l,E){nn(n,C,l,E),z(l,E,l,E)}function ln(n,C,l,E){nn(n,C,l,E),h(l,E,l,E)}function En(n,C,l){if(null==n||null==C||l.source.spatialReference===n&&l.dest.spatialReference===C)return l;const E=F(n,l.source),e=F(C,l.dest);return E===i.UNKNOWN&&e===i.UNKNOWN?c(n,C)?l.projector=f:l.projector=null:l.projector=o[E][e],l}function en(){return{source:{spatialReference:null,spatialReferenceId:i.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:i.UNKNOWN,metersPerUnit:1},projector:f}}const Sn={spatialReference:null,spatialReferenceId:i.UNKNOWN},An={spatialReference:null,spatialReferenceId:i.UNKNOWN},_n=en(),tn=l(1),Rn=n(1);export{i as ProjectionID,F as classifySpatialReference,f as copy3,en as createEmptyProjectorCache,An as destClassificationCache,W as getProjector,T as getProjectorName,G as getWGS84ComparableLonLatProjector,U as invPlateCarreeScale,d as lonLatToWebMercatorComparable,En as populateProjectorCache,o as projectionTable,_n as projectorCache,Sn as sourceClassificationCache,D as sphericalPCPFtoLonLatElevation,h as wgs84ToWebMercator};
