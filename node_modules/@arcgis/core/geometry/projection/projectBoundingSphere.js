/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{deg2rad as e}from"../../core/mathUtils.js";import{c as r}from"../../chunks/vec3f64.js";import{createEmptyProjectorCache as t,populateProjectorCache as n,copy3 as o,ProjectionID as s,projectionTable as c,wgs84ToWebMercator as i}from"./projectors.js";import{earth as l}from"../support/Ellipsoid.js";function a(e,r,t,a){if(null==r||null==a)return!1;const E=n(r,a,p);if(E.projector===o)return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],!0;if(null==E.projector)return!1;const{source:R,dest:m}=E;if(m.spatialReferenceId===s.WEB_MERCATOR){const r=c[R.spatialReferenceId][s.WGS84];return null!=r&&(r(e,0,f,0),i(f,0,t,0),t[3]=u(f[1],e[2],e[3],l.radius),!0)}if(R.spatialReferenceId!==s.WGS84&&R.spatialReferenceId!==s.CGCS2000||m.spatialReferenceId!==s.PLATE_CARREE){E.projector(e,0,t,0);const r=R.metersPerUnit??1,n=m.metersPerUnit??1;t[3]=e[3]*r/n}else{const r=c[R.spatialReferenceId][s.SPHERICAL_ECEF],n=c[s.SPHERICAL_ECEF][s.PLATE_CARREE];let o=e[3];null!=r&&null!=n&&(o=u(e[1],e[2],e[3],l.radius)),E.projector(e,0,t,0),t[3]=o}return!0}function u(e,r,t,n){const o=n+r;if(o<n/2||t>o)return Number.MAX_VALUE;const s=Math.abs(E*e)+Math.asin(t/o);return s>=Math.PI/2?Number.MAX_VALUE:t/Math.cos(s)}const f=r(),p=t(),E=e(1);export{a as projectBoundingSphere};
