/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
import{_ as t}from"../../chunks/tslib.es6.js";import{JSONSupport as o}from"../../core/JSONSupport.js";import{clone as r}from"../../core/lang.js";import n from"../../core/Logger.js";import{property as e}from"../../core/accessorSupport/decorators/property.js";import{cast as s}from"../../core/accessorSupport/decorators/cast.js";import{subclass as a}from"../../core/accessorSupport/decorators/subclass.js";var i;const l="esri.geometry.support.MeshVertexAttributes",c=n.getLogger(l);let p=i=class extends o{constructor(t){super(t),this.color=null,this.position=new Float64Array(0),this.uv=null,this.normal=null,this.tangent=null}castColor(t){return g(t,Uint8Array,[Uint8ClampedArray],{loggerTag:".color=",stride:4},c)}castPosition(t){t&&t instanceof Float32Array&&c.warn(".position=","Setting position attribute from a Float32Array may cause precision problems. Consider storing data in a Float64Array or a regular number array");return g(t,Float64Array,[Float32Array],{loggerTag:".position=",stride:3},c)}castUv(t){return g(t,Float32Array,[Float64Array],{loggerTag:".uv=",stride:2},c)}castNormal(t){return g(t,Float32Array,[Float64Array],{loggerTag:".normal=",stride:3},c)}castTangent(t){return g(t,Float32Array,[Float64Array],{loggerTag:".tangent=",stride:4},c)}clone(){const t={position:r(this.position),uv:r(this.uv),normal:r(this.normal),tangent:r(this.tangent),color:r(this.color)};return new i(t)}clonePositional(){const t={position:r(this.position),normal:r(this.normal),tangent:r(this.tangent),uv:this.uv,color:this.color};return new i(t)}get memoryUsage(){let t=0;return t+=this.position.byteLength,null!=this.uv&&(t+=this.uv.byteLength),null!=this.normal&&(t+=this.normal.byteLength),null!=this.tangent&&(t+=this.tangent.byteLength),null!=this.color&&(t+=this.color.byteLength),t}};function u(t,o,r,n){const{loggerTag:e,stride:s}=o;return t.length%s!=0?(n.error(e,`Invalid array length, expected a multiple of ${s}`),new r([])):t}function g(t,o,r,n,e){if(!t)return t;if(t instanceof o)return u(t,n,o,e);for(const s of r)if(t instanceof s)return u(new o(t),n,o,e);if(Array.isArray(t))return u(new o(t),n,o,e);{const n=r.map((t=>`'${t.name}'`));return e.error(`Failed to set property, expected one of ${n}, but got ${t.constructor.name}`),new o([])}}function y(t,o,r){o[r]=m(t)}function m(t){const o=new Array(t.length);for(let r=0;r<t.length;r++)o[r]=t[r];return o}t([e({json:{write:y}})],p.prototype,"color",void 0),t([s("color")],p.prototype,"castColor",null),t([e({nonNullable:!0,json:{write:y}})],p.prototype,"position",void 0),t([s("position")],p.prototype,"castPosition",null),t([e({json:{write:y}})],p.prototype,"uv",void 0),t([s("uv")],p.prototype,"castUv",null),t([e({json:{write:y}})],p.prototype,"normal",void 0),t([s("normal")],p.prototype,"castNormal",null),t([e({json:{write:y}})],p.prototype,"tangent",void 0),t([s("tangent")],p.prototype,"castTangent",null),p=i=t([a(l)],p);export{p as MeshVertexAttributes,g as castArray};
